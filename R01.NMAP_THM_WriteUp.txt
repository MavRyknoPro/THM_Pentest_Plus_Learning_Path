******************************************************************************

Task 1: Deploy 

******************************************************************************

Task 2: Introduction

[Question 1]: What networking constructs are used to direct traffic to the right application on a server?

	[*] In the introduction it was written : "When a computer runs a network service, it opens a networking construct called a 'port' to receive the connection.

	[!] Answer: ports

[Question 2]: How many of these are available on any network-enabled computer?

	[!] Answer: 65535

[Question 3]: How many of these are considered "well-known"?
	
	[?] What are the well-known ports? 
	
	# Well-Known ports are port numbers that have been reserved for common applications, typically server applications.
	
	# Example: 

		- Port 80 for HTTP.
		- Port 443 for HTTPS.
		- Port 22 for SSH.
		- ...
	
	[*] Ports 0 through 1023 are defined as well-known ports.
	
	[!] Answer: 1024

******************************************************************************

Task 3: Nmap Switches

	# Read man of Nmap.
	//https://linux.die.net/man/1/nmap
	
	[*] We can use command "man nmap" to read nmap options (switches).

[Question 1]: What is the first switch listed in the help menu for a 'Syn Scan'?
	
	[!] Answer: -sS 

	[*] Or we can use command "man nmap | grep -i syn" to read nmap options for "Syn Scan".

[Question 2]: Which switch would you use for a "UDP scan"?
	
	[!] Answer: -sU
	
	[*] Same the first question, we can use command "man nmap | grep -i UDP" to read nmap options for "UDP Scan".

[Question 3]: If you wanted to detect which operating system the target is running on, which switch would you use?

	[!] Answer: -O

	[*] We can use command "nmap -h | grep OS" to read options for OS 

[Question 4]: Nmap provides a switch to detect the version of the services running on the target. What is this switch?

	[!] Answer: -sV 

[Question 5]: The default output provided by nmap often does not provide enough information for a pentester. How would you increase the verbosity?

	[!] Answer: -v

[Question 6]: Verbosity level one is good, but verbosity level two is better! How would you set the verbosity level to two?
(Note: it's highly advisable to always use at least this option)

	[!] Answer: -vv

[Question 7]: What switch would you use to save the nmap results in three major formats?

	[!] Answer: -oA
	
[Question 8]: What switch would you use to save the nmap results in a "normal" format?

	[!] Answer: -oN 
	
[Question 9]: A very useful output format: how would you save results in a "grepable" format?

	[!] Answer: -oG
	
[Question 10]: Sometimes the results we're getting just aren't enough. If we don't care about how loud we are, we can enable "aggressive" mode. This is a shorthand switch that activates service detection, operating system detection, a traceroute and common script scanning.

How would you activate this setting?

	[!] Answer: -A
	
	[*] We can use command "man nmap | grep -i traceroute" to see more options
	
[Question 11]: Nmap offers five levels of "timing" template. These are essentially used to increase the speed your scan runs at. Be careful though: higher speeds are noisier, and can incur errors!

How would you set the timing template to level 5?

	[*] TIMING AND PERFORMANCE:
	
  		-T<0-5>: Set timing template (higher is faster)
  		
  	[!] Answer: -T5
  	
[Question 12]: We can also choose which port(s) to scan.

How would you tell nmap to only scan port 80?

	[!] Answer: -p 80
	
[Question 13]: How would you tell nmap to scan ports 1000-1500? 

	[!] Answer: -p 1000-1500
	
[Question 14]: A very useful option that should not be ignored:

How would you tell nmap to scan all ports?

	[!] Answer: -p- 
	
[Question 15]: How would you activate a script from the nmap scripting library ?
  	
  	[!] Answer: --script
  	
[Question 16]: How would you activate all of the scripts in the "vuln" category?

	[!] Answer: --script=vuln
	
	[*] We can use command "nmap -h | grep -i script" to read more options of "script"


******************************************************************************

Task 4: OverView 

** In this task, you need Read the Scan Types Introduction and Complete it.


******************************************************************************

Task 5: TCP Connect Scans

** To understand TCP Connect Scans, you must have knowledge about Three-Way-HandShake.

[Question 1]: Which RFC defines the appropriate behavior for the TCP protocol ? 
	
	[!] Answer: RFC 9293

[Question 2]: If a port is closed, which flag should the server send back to indicate this ?

	[!] Answer: RST 

******************************************************************************

Task 6: SYN Scans

SYN Scans (-sS) 

[Question 1]: There are two other names for a SYN Scan, what are they ?

	[*] SYN Scans are sometimes referred to as “Half-open” or “Stealth” scans.

	[!] Answer: Half-open, Stealth

[Question 2]:  Can Nmap use a SYN Scan without Sudo Permissions (Y/N) ?

	[*] While it is possible to run some of Nmap's basic functions as an unprivileged/normal user, using most of its advanced features requires root or sudo privileges.

	[*] If run without sudo permissions, Nmap default to the TCP Scans. 

	[!] Answer: N

******************************************************************************

Task 7: UDP Scans

** Unlike TCP, UDP connections are stateless. 

	[*] The switch for an Nmap UDP Scan is (-sU)



[Question 1]: If a UDP port doesn’t respond to an Nmap scan, what will it be marked as ? 

	[!] Answer: open|filterd

	[*] When a packet is sent to an open UDP port, there should be no response. When this happens, 
Nmap refers to the port as being OPEN|FILTERED.

[Question 2]: When a UDP port is closed, by convention the target should send a “port unreachable” message. Which protocol would it use to do so ? 

	[!] Answer: ICMP

******************************************************************************

Task 8: NULL, FIN and Xmas 

[Question 1]: Which of the three shown scan types uses the URG flag? 

	[!] Answer: xmas

	[*] As with the other two scans in this class, Xmas scans (-sX) can scan the URG flag. 
 
	[*] This type Scan send a malformed TCP packet and expects a RST respond for closed port.


[Question 2]: Why are NULL, FIN and Xmas scans generally used ?

	[!] Answer: Firewall Evasion 

[Question 3]: Which common OS may respond to a NULL, FIN or Xmas scan with a RST for every port? 

	[!] Answer: Microsoft Windows

******************************************************************************

Task 9: ICMP Network Scanning 

[Question 1]: How would you perform a ping sweep on the 127.16.x.x network (Netmask: 255.255.0.0) using Nmap (CIDR notation)
	[!] Answer: nmap -sn 172.16.0.0/16

	[*]: IPv4 have 4 octet. 
	[*]: Netmask: 255.255.0.0: The third octet and four octet isn’t use and this behavior tell me why I have /16 for scan -sn

******************************************************************************

Task 10:  NSE scripts Overview

[Question 1]: What language are NSE scripts written in? 

	[!] Answer: Lua 

[Question 2]: Which category of scripts would be a very bad idea to run in production environment?
	
	[!] Answer: intrusive 


******************************************************************************

Task 11: NSE scripts Working with the NSE 

[Question 1]: What optional argument can the “ftp-anon.nse” script take?

	[!] Answer: maxlist 

******************************************************************************

Task 12: NSE Scripts Searching for Scripts 

[Question 1]: Search for "smb" scripts in the /usr/share/nmap/scripts/ directory using either of the demonstrated methods.
What is the filename of the script which determines the underlying OS of the SMB server?

	[!] Answer: smb-os-discovery.nse 



[Question 2]: Read through this script. What does it depend on? 

	[!] Answer: smb-brute
	
******************************************************************************

Task 13: Firewall Evasion 

[Question 1]: Which simple (and frequently relied upon) protocol is often blocked, requiring the use of the (-Pn) switch? 

	[!] Answer: ICMP 

	[*] Which tells Nmap to not bother pinging the host before scanning it. 

	[*] Nmap will always treat the target hosts as being alive, effectively bypassing the ICMP block.

 [Question 2]: Research - Which Nmap switch allows you to append an arbitrary length of random data to the end of packets? 

	[!] Answer: –data-length 

******************************************************************************

Task 14: Practical

[Question 1]: Does the target (Machine_IP) respond to ICMP (ping) request (Y/N)?

	[*] ping <machine_IP> 
	
	[!] Answer: N

[Question 2]: Perform an Xmas scan on the first 999 ports of the target – how many ports are shown to be open or filtered?

	[*] nmap -sX -Pn <machine_IP>
	
	[!] Answer: 999

[Question 3]: Note: The answer will be in your scan results. Think carefully about which switches to use – and read the hint before asking for help! 

	[*] nmap -vv -Pn <machine_IP>

	[!] Answer: No Response

[Question 4]: Perform a TCP SYN scan on the first 5000 ports of the target – how many port are shown to be open? 

	[*] nmap -sS -Pn <machine_IP>

	[!] Answer: 5 

[Question 5]: No answer needed 

[Question 6]: Deploy the (ftp-anon) script against the box. Can Nmap login successfully to the FTP server on port 21? (Y/N)

	[*] nmap - -script=ftp-anon <machine_IP>

	[!] Answer: Y

******************************************************************************

Task 15: Conclusion 

	[*] Nmap is allot to take in and will only remember most of it by just using it.
